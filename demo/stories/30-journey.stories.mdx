import { Story, Meta, html, Preview } from '@open-wc/demoing-storybook';

<Meta title="Intro/Journey" />

# Scaling up Web Components

# INGs Web Components Journey

Early on, we betted on web components and we experienced all the issues and changes Web Components are known for. In the end we could overcome all issues and enjoy a productive scalable workflow with all the benefits of Web Components.

This is how we did it.

## How ING started with Web Components

Using right from the start with html imports, v0 custom elements, v0 shadow dom and custom template system.

This lead to a lot of problems, so a decision was made to start with a clean slate.

## Starting a new Journey

We started ing-web with three important requirements in mind:

- Accessibility
- Performance
- Flexibility

This meant we had to start from scratch, yet always stay aligned with new ideas like lit-html and lit-element.
We started with our own solutions and eventually adopted these new technologies.

## Separated the functionality with styling (2 tier system)

In the past we changed our codebase every few years, starting all over again. Rewriting the same functionalities, but with a different style guide.

By separating functionality and ing specific styling we aimed to be to able to:

- Switch from one style guide to another, without throwing away all functionality related code.
- To be able to have different variations of features and components

But we also got some unexpected benefits like:

- Fully focus on a good developer API, without caring too much on how it will look.
- Being able to create a component without have the designs ready.
- Keeping a clean code base by having the backwards compatibilty code on a different layer. Therefore allowing ourselves to innovate and break often (also known as "fail fast") on the functionality layer.

## Releasing the first internal version

The internal need to have a stable version was big, so we finalized some of our systems, but we were not yet feature complete.

Slowly more features and systems were added, though our consumers expected more feature completeness, and more maturity.

## Struggle to scale

We already had a big component set and people expected a lot of features right from the start.

We found features that could not be made without a breaking change, so plans were made for a v2. Since most applications don't like to migrate but prefer to work on new features, we kept on postponing it.

We soon realized that we were never going to be able to build the entire company in terms of components, not with just our team.
We had to find a solution to scale up.

## Community to the rescue

We started scaling by using the community of developers in ING

First we had a very high quality bar to contribute. This made the threshold for contributions high, and with developers having their own squad responsibilities, very few contributions made it to our component library, and the progress was not always pleasant.

We decided there was a need for a low threshold approach so we created an experimental repository for work-in-progress components.
We called it labs, and basically accepted every contribution regardless of quality or alignment with branding or UX.
Suffice to say, people went a bit crazy, and before we knew it the repository was a mess with lots of duplicate components of varying quality.

Contributors did not collaborate with us or with each other, to create better components, but instead the same component was added multiple times, but with a different API.

We learned that we need a more collaborative approach with more guidance.
So we set a standard in terms of how far UX specifications should be complete before even starting to work on coding the component.
In addition, our team provides blueprints for components that meet this standard and that people want to contribute.
This blueprint makes the fundamentals like the developer API and some technical details, concrete.
This helps facilitate discussion and prevents contributors from going the complete opposite direction.

We also added a role in our team specifically for directly communicating with contributors to give feedback early. This feels more like helping, and less like judging.

We started actively asking for volunteers to help out, not just for new components, but also for adding features to existing components and helping to solve bugs and issues. We start them off with some simpler tasks (though still beneficial!) to get them acquainted with our way of work, conventions, our codebase, etc.

Then, we slowly increase the complexity of tasks and soon we had contributors from outside the team that we can trust to deliver high quality code to our codebase!

## Plan for v2

In the meantime the need for breaking changes grew each sprint.

So we started to do the breaking changes we wanted.

Which turned out to be a lot.

To mitigate all these changes for our feature/application developers we came up with a way to support both versions of our internal code base.

## Scoped Elements

The reason why it is usually impossible to have multiple major versions of the same component is a technical one; the CustomElementsRegistry is global, and registering the same element twice under the same name is therefore impossible.

In ING this is a major problem because teams need to be able to upgrade at their own pace, and applications should be able to have multiple version of the same component. The alternative is a single, globally aligned, big bang migration. This makes no one happy.

Because we cannot wait for a solution to hit the browsers, the guys at @open-wc created a solution for now, which scopes your custom elements, making it possible to have multiple versions of the same component.

### how does it work

Your custom elements apply a mixin, which scopes the tags that are used inside that component, by adding hashes to the name. It rewrites your templates to use the correct tag, and there is even a helper for getting the hashed tag name.

### impact

Everyone that is using or creating shared dependencies with the next major version of our component library, will be required to use this scoped elements solution. This is important to mitigate any conflicts that could occur if the same component is registered more than once.

## Migration Conclusion

The big benefit of using this package, is that applications and features can be migrated to the next major version whenever they want. This means that teams can autonomously migrate, following their own planning.

## ING and Web Components

So we basically hit every issue that is known for Web Components.

Some examples

- Accessibility and ShadowDOM, which we overcame in our form system
- Scalabilty, which we overcame by harnesing the power of the community
- Using multiple major versions of the same component, which we overcame with scoped elements
- Performance we overcame with staying close to the platform (browser)

We are at a point where we are very satisfied with our workflow, our technology stack and what is on the horizon.
The bet on Web Components seems to have been worth it, and hopefully you as our reader can take something from our journey to enjoy it too!
